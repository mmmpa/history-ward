(function(){var t,o=function(t,o){return function(){return t.apply(o,arguments)}},n=[].slice;window.HistoryWard=t=function(){function t(t){this.isBrutal=t,this.onPopState=o(this.onPopState,this),this.uid=0,this.position=0,window.addEventListener("popstate",this.onPopState)}return t.PUSHSTATE="pushstate",t.FORWARD="popstate:forward",t.BACKWARD="popstate:backword",t.one=null,t.start=function(o){return t.one?t.one:t.one=new t(o)},t.startBrutally=function(){return t.start(!0),History.prototype.pushStatePure=History.prototype.pushState,History.prototype.pushState=function(){var o,e;return o=1<=arguments.length?n.call(arguments,0):[],(e=t.one).pushState.apply(e,o)}},t.prototype.clean=function(t){return t},t.prototype.dispatch=function(t,o){return window.dispatchEvent(new o.constructor(t,this.clean(o)))},t.prototype.isBackward=function(t){var o;return null==(null!=(o=t.state)?o.historyWardUID:void 0)?!0:t.state.historyWardUID<this.position},t.prototype.onPopState=function(o){return o.preventDefault(),this.isBackward(o)?this.dispatch(t.BACKWARD,o):this.dispatch(t.FORWARD,o),this.shift(o)},t.prototype.pushState=function(o,n,e){return null==o&&(o={}),o.historyWardUID=this.position=this.uid+=1,this.isBrutal?history.pushStatePure(o,n,e):history.pushState(o,n,e),window.dispatchEvent(new CustomEvent(t.PUSHSTATE,{detail:{state:o,title:n,url:e}}))},t.prototype.resume=function(){return window.addEventListener("popstate",this.onPopState)},t.prototype.shift=function(t){var o;return this.position=null!=(null!=(o=t.state)?o.historyWardUID:void 0)?t.state.historyWardUID:0},t.prototype.stop=function(){return window.removeEventListener("popstate",this.onPopState)},t}()}).call(this);